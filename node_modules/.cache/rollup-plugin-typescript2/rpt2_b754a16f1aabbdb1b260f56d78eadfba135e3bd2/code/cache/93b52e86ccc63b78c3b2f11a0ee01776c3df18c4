{"code":"import { ApiCreateApp } from \"./apiCreateApp\";\nimport { crteatComponentInstance, setupComponent } from \"./component\";\nimport { effect } from \"@vue/reactivity\";\nimport { CVnode, TEXT } from \"./vnode\";\nexport function createRender(renderOptionsDom) {\n    // 获取全部的dom操作\n    const { insert: hostInsert, remove: hostRemove, patchProp: hostPatchProp, forcePatchProp: hostForcePatchProp, createElement: hostCreateElement, createText: hostCreateText, createComment: hostCreateComment, setText: hostSetText, setElementText: hostSetElementText, } = renderOptionsDom;\n    function setupRenderEffect(instance, container) {\n        // 创建effect 在effect中调用render方法，render就能收集依赖\n        effect(function componentEffect() {\n            if (!instance.isMounted) { // 第一次加载\n                // 获取到render的返回值\n                let proxy = instance.proxy;\n                let subTree = instance.render.call(proxy, proxy); // 执行render,在组件中创建dom节点\n                //将h函数返回的vnode渲染到页面\n                patch(null, subTree, container);\n            }\n        });\n    }\n    //----------------- 处理文本-----------------\n    const processtext = (n1, n2, container) => {\n        if (n1 === null) {\n            // 创建文本 =》真实dom =》 加载到页面\n            n2.el = hostCreateText(n2.children);\n            hostInsert(n2.el, container);\n        }\n        else {\n        }\n    };\n    //-------------- 处理组件 ------------------\n    // 组件渲染的流程\n    const mountComponent = (InitialVnode, container) => {\n        // 1. 先有一个组件的实例对象\n        const instance = InitialVnode.component = crteatComponentInstance(InitialVnode);\n        // 2.解析数据到这个实例对象中\n        setupComponent(instance);\n        // 3.创建一个effect ，让render函数执行\n        setupRenderEffect(instance, container);\n    };\n    // 组件的创建\n    const processComponent = (n1, n2, container) => {\n        if (n1 === null) { // 第一次加载\n            mountComponent(n2, container);\n        }\n        else { // 更新操作\n        }\n    };\n    // -------------- 处理元素 ---------------\n    const mountChildren = (el, children) => {\n        children.forEach((item) => {\n            let child = CVnode(item);\n            patch(null, child, el);\n        });\n    };\n    const mountElement = (n2, container) => {\n        // 递归渲染  =》 真实dom =》 放到对应的页面\n        const { props, shapeFlag, type, children } = n2;\n        // 创建元素\n        let el = hostCreateElement(type);\n        //添加属性\n        if (props) {\n            for (let k in props) {\n                hostPatchProp(el, k, null, props[k]);\n            }\n        }\n        // 处理children\n        if (children) {\n            if (shapeFlag & 8 /* ShapeFlags.TEXT_CHILDREN */) {\n                // 创建文本元素\n                hostSetElementText(el, children);\n            }\n            else if (shapeFlag & 16 /* ShapeFlags.ARRAY_CHILDREN */) {\n                // 递归\n                mountChildren(el, children);\n            }\n        }\n        // 加载到对应的位置\n        hostInsert(el, container);\n    };\n    function processElement(n1, n2, container) {\n        if (n1 === null) {\n            mountElement(n2, container);\n        }\n        else {\n        }\n    }\n    // 渲染的操作\n    const patch = (n1, n2, container) => {\n        // 针对不同的类型   \n        let { shapeFlag, type } = n2;\n        switch (type) {\n            case TEXT:\n                processtext(n1, n2, container);\n                break;\n            default:\n                if (shapeFlag & 1 /* ShapeFlags.ELEMENT */) { // 元素\n                    processElement(n1, n2, container);\n                }\n                else if (shapeFlag & 4 /* ShapeFlags.STATEFUL_COMPONENT */) { //组件\n                    processComponent(n1, n2, container);\n                }\n        }\n    };\n    let render = (vnode, container) => {\n        // 组件的初始化\n        patch(null, vnode, container); // 第一次 渲染\n    };\n    return {\n        createApp: ApiCreateApp(render) // 创建虚拟dom\n    };\n}\n//# sourceMappingURL=render.js.map","references":["C:/Users/JuaryLiu/Desktop/vue3-core/packages/shared/src/index.ts","C:/Users/JuaryLiu/Desktop/vue3-core/packages/runtime-core/src/apiCreateApp.ts","C:/Users/JuaryLiu/Desktop/vue3-core/packages/runtime-core/src/component.ts","C:/Users/JuaryLiu/Desktop/vue3-core/packages/reactivity/src/index.ts","C:/Users/JuaryLiu/Desktop/vue3-core/packages/runtime-core/src/vnode.ts"],"map":"{\"version\":3,\"file\":\"render.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../../packages/runtime-core/src/render.ts\"],\"names\":[],\"mappings\":\"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\"}"}
