{"code":"import { isFunction, isObject } from \"@vue/shared\";\nimport { componentPubilcInstance } from \"./componentPubilcInstance\";\n// 创建一个组件实例\nexport const crteatComponentInstance = (InitialVnode) => {\n    const instance = {\n        InitialVnode,\n        type: InitialVnode.type,\n        props: {},\n        attrs: {},\n        setupState: {},\n        ctx: {},\n        proxy: {},\n        render: false,\n        isMounted: false, // 是否挂载 \n    };\n    instance.ctx = { _: instance };\n    return instance;\n};\n// 解析数据到组件实例\nexport const setupComponent = (instance) => {\n    const { props, children } = instance.InitialVnode;\n    instance.props = props;\n    instance.children = children; // slots 插槽\n    // 判断这个组件有没有setup\n    let shapeFlag = instance.InitialVnode.shapeFlag & 4 /* ShapeFlags.STATEFUL_COMPONENT */;\n    if (shapeFlag) { // 有状态的组件\n        setupStateComponent(instance);\n    }\n};\n// 处理 setup\nfunction setupStateComponent(instance) {\n    instance.proxy = new Proxy(instance.ctx, componentPubilcInstance); // 方便取值\n    // setup 的返回值 是render函数的参数\n    let Component = instance.type;\n    let { setup } = Component;\n    if (setup) { // 判断setup是否存在\n        let setupContext = createContext(instance);\n        let setupResult = setup(instance.props, setupContext);\n        handlerSetupResult(instance, setupResult); // 判断返回值是对象还是函数，对象就把结果放到instance.setupState上，如果是 函数，那么就是render函数\n    }\n    else {\n        // 调用render\n        finishComponentSetup(instance);\n    }\n    Component.render(instance.proxy);\n}\n// 处理setup 的返回结果\nfunction handlerSetupResult(instance, setupResult) {\n    if (isObject(setupResult)) {\n        instance.setupState = setupResult;\n    }\n    if (isFunction(setupResult)) {\n        instance.render = setupResult;\n    }\n    // 执行render方法\n    finishComponentSetup(instance);\n}\n// 处理render\nfunction finishComponentSetup(instance) {\n    let Component = instance.type;\n    if (!instance.render) {\n        if (!Component.render && Component.template) { // 将template编译成render函数\n        }\n        instance.render = Component.render;\n    }\n    instance.render();\n}\nfunction createContext(instance) {\n    return {\n        attrs: instance.attrs,\n        slots: instance.children,\n        emit: () => { },\n        expose: () => { }\n    };\n}\n//# sourceMappingURL=component.js.map","references":["C:/Users/JuaryLiu/Desktop/vue3-core/packages/shared/src/index.ts","C:/Users/JuaryLiu/Desktop/vue3-core/packages/runtime-core/src/componentPubilcInstance.ts"],"map":"{\"version\":3,\"file\":\"component.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../../packages/runtime-core/src/component.ts\"],\"names\":[],\"mappings\":\"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\"}"}
