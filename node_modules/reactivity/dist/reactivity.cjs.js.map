{"version":3,"file":"reactivity.cjs.js","sources":["../../shared/src/index.ts","../src/effect.ts","../src/baseHandlers.ts","../src/reactivety.ts","../src/ref.ts","../src/computed.ts"],"sourcesContent":["export const extend = Object.assign\r\n\r\nconst hasOwnProperty = Object.prototype.hasOwnProperty\r\nexport const hasOwn = (\r\n    val: object,\r\n    key: string | symbol\r\n): key is keyof typeof val => hasOwnProperty.call(val, key)\r\n\r\nexport const isArray = Array.isArray\r\n\r\nexport const isFunction = (val: unknown): val is Function =>\r\n    typeof val === 'function'\r\n\r\nexport const isString = (val: unknown): val is string => typeof val === 'string'\r\nexport const isSymbol = (val: unknown): val is symbol => typeof val === 'symbol'\r\nexport const isObject = (val: unknown): val is Record<any, any> => val !== null && typeof val === 'object'\r\n\r\n// 判断数组的key 是不是一个整数\r\nexport const isIntegerKey = (key:any) => parseInt(key) +'' === key\r\n\r\n\r\n//判断两个值是否相等\r\nexport const hasChanged  = (value:any,oldval:any):boolean => value !==oldval\r\nexport * from './shapeFlag'","// effect 收集依赖\r\n\r\nimport { isArray, isIntegerKey } from \"@vue/shared\"\r\nimport { TriggerOpTypes } from \"./operations\"\r\n\r\nexport function effect(fn: Function, options: any = {}) {\r\n    const effect = createReactEffect(fn, options)\r\n    if (!options.lazy) {\r\n        effect()\r\n    }\r\n\r\n    return effect\r\n}\r\nlet uid = 0\r\nlet activeEffect: any  //保存当前的effect\r\n\r\nconst effectStack: any = []  //定义一个栈结构 来解决effect的树结构\r\nfunction createReactEffect(fn: Function, options: any) {\r\n    const effect = function reactiveEffect() {\r\n        // 防止多个effect嵌套\r\n        if (!effectStack.includes(effect)) { // 确保effect 没有入栈\r\n            try {\r\n                // 入栈\r\n                effectStack.push(effect)\r\n                activeEffect = effect\r\n                 return fn()\r\n            } finally {\r\n                // 出栈\r\n                effectStack.pop()\r\n                activeEffect = effectStack[effectStack.length - 1]\r\n            }\r\n        }\r\n\r\n    }\r\n    effect.id = uid++  // 区别effect作用者\r\n    effect._isEffect = true // 区分effect 是不是响应式的\r\n    effect.raw = fn  //保存用户的方法\r\n    effect.options = options  //保存用户的配置项\r\n    return effect\r\n}\r\n\r\n// 收集effect 触发get的时候 收集effect\r\nlet targetMap = new WeakMap() // 创建结构表\r\nexport function Track(target: object, type: any, key: string | symbol) {\r\n    // 对应的key \r\n    // key 和 effect 一一对应  map => key =>target对象 value => [effect] set\r\n    if(activeEffect === undefined) { //没有effect中使用\r\n        return\r\n    }\r\n     // 获取effect\r\n     let depMap = targetMap.get(target)\r\n    if(!depMap) {\r\n        targetMap.set(target,(depMap = new Map))\r\n    }\r\n    let dep = depMap.get(key)\r\n    if(!dep) { //没有属性\r\n        depMap.set(key,(dep = new Set))\r\n    }\r\n    if(!dep.has(activeEffect)) {\r\n        dep.add(activeEffect)\r\n    }\r\n    // console.log(targetMap);\r\n}\r\n\r\nexport function trigger(target:object,type:any,key?:any,newValue?:any,oldValue?:any) {\r\n    // console.log(target,key,type,newValue,oldValue);\r\n    const depsMap = targetMap.get(target) //Map\r\n    // 收集依赖结构表中没有这个对象\r\n    if(!depsMap) return\r\n    //有\r\n    let effectSet = new Set() // 避免重复，减少执行次数\r\n    const add = (effectAdd:any) => {\r\n        if(effectAdd) {\r\n            effectAdd.forEach((effect:any)=> effectSet.add(effect))\r\n        }\r\n    }\r\n\r\n    // 处理数组 当key为lenght的时候   就是修改数组的length\r\n    if(key === 'length' && isArray(target)) {\r\n        depsMap.forEach((dep:any,key:any) => {\r\n            if(key === 'length' || key >= (newValue as number)) {\r\n                add(dep)\r\n            }\r\n        })\r\n    } else {\r\n        // 可能是对象\r\n        if(key != undefined) {\r\n            add(depsMap.get(key))\r\n        }\r\n        // 数组 通过索引来修改\r\n        switch(type) {\r\n            case TriggerOpTypes.ADD:\r\n                if(isArray(target)&&isIntegerKey(key)) {\r\n                    add(depsMap.get('length'))\r\n                }\r\n        }\r\n    }\r\n    effectSet.forEach((effect:any) => {\r\n        if(effect.options.sch) {\r\n            effect.options.sch() // 此时_dirty = true\r\n        } else {\r\n            effect()\r\n        }\r\n    } )\r\n    \r\n}","import { isObject, isArray, isIntegerKey, hasOwn, hasChanged } from \"@vue/shared\"\r\nimport { reactive, readonly } from \"./reactivety\"\r\nimport { TrackOpTypes, TriggerOpTypes } from './operations'\r\nimport { Track, trigger } from './effect'\r\n/**\r\n * \r\n * @param isReadonly 是否只读\r\n * @param shallow  是否是浅代理\r\n * @returns  get函数 有三个参数分别是target：目标对象，key：目标对象的属性 receiver：目标对象的实例\r\n */\r\nfunction createGetter(isReadonly = false, shallow = false) {\r\n    return function get(target: object, key: string | symbol, receiver: object) {\r\n        const res = Reflect.get(target, key, receiver) // target[k]\r\n        if (!isReadonly) {\r\n            // 收集依赖\r\n            Track(target, TrackOpTypes.GET, key)\r\n        }\r\n        if (shallow) {\r\n            return res\r\n        }\r\n        if (isObject(res)) { // key是一个对象的时候\r\n            return isReadonly ? readonly(res) : reactive(res) // 递归\r\n        }\r\n        return res\r\n    }\r\n}\r\nconst get = createGetter()\r\nconst shallowGet = createGetter(false, true)\r\nconst readonlyGet = createGetter(true, false)\r\nconst shallowReadonlyGet = createGetter(true, true)\r\n\r\nfunction createSetter(shallow = false) {\r\n    return function (target: any, key: string | symbol, value: unknown, receiver: object) {\r\n        const oldvalue = target[key]\r\n        const result = Reflect.set(target, key, value, receiver)\r\n        let haskey = isArray(target) && isIntegerKey(key) ? Number(key) < target.length : hasOwn(target, key)\r\n        if (!haskey) { // 数组新增\r\n            trigger(target, TriggerOpTypes.ADD, key, value)\r\n        } else if (hasChanged(value, oldvalue)) { // 数组修改,当新值与原来的值一样的时候\r\n            trigger(target, TriggerOpTypes.SET, key, value, oldvalue)\r\n        }\r\n        return result\r\n    }\r\n}\r\nconst set = createSetter()\r\nconst shallowSet = createSetter(true)\r\nexport const reactiveHandlers = {\r\n    get,\r\n    set\r\n}\r\n\r\nexport const readonlyHandlers = {\r\n    get: readonlyGet,\r\n    set: () => {\r\n        console.log('只读！！！无法修改值');\r\n    }\r\n}\r\n\r\nexport const shallowReactiveHandlers = {\r\n    get: shallowGet,\r\n    set: shallowSet\r\n}\r\n\r\nexport const shallowReadonlyHandlers = {\r\n    get: shallowReadonlyGet,\r\n    set: () => {\r\n        console.log('只读！！！无法修改值改值');\r\n    }\r\n}","//四个方法的注重点 ： 1.是不是可读 2.是不是深代理\r\n// 核心proxy 源码中采用高阶函数的柯里化\r\nimport { isObject } from \"@vue/shared\" \r\nimport {\r\n    reactiveHandlers,\r\n    readonlyHandlers,\r\n    shallowReactiveHandlers,\r\n    shallowReadonlyHandlers\r\n  } from './baseHandlers'\r\nexport function reactive(target:Object) {\r\n   return createReactObj(target,false,reactiveHandlers)\r\n}\r\n\r\nexport function shallowReactive(target:Object) {\r\n    return createReactObj(target,false,shallowReactiveHandlers)\r\n}\r\n\r\nexport function readonly(target:Object) {\r\n    return createReactObj(target,true,readonlyHandlers)\r\n}\r\n\r\nexport function shallowReadonly(target:Object) {\r\n    return createReactObj(target,true,shallowReadonlyHandlers)\r\n}\r\n\r\n//核心代理的实现\r\n//数据结构，用来收集被代理的数据，避免重复代理\r\nconst reactiveMap = new WeakMap() // 类似于map，但是这个key必须是对象，并且会自动的垃圾回收\r\nconst readonlyMap = new WeakMap()\r\nfunction createReactObj(target:any,isReadonly:boolean,baseHandlers:object) {\r\n    if(!isObject(target)) {\r\n        return target\r\n    }\r\nconst proxymap = isReadonly?readonlyMap:reactiveMap\r\nconst proxyEs = proxymap.get(target) //proxymap中是否存在被代理的target\r\nif(proxyEs) {\r\n    return proxyEs\r\n}\r\n\r\nconst proxy = new Proxy(target,baseHandlers)\r\nproxymap.set(target,proxy)\r\n  return proxy\r\n}","import { hasChanged, isArray } from \"@vue/shared\"\r\nimport { Track, trigger } from \"./effect\"\r\nimport { TrackOpTypes, TriggerOpTypes } from \"./operations\"\r\n\r\nexport function ref(rawValue:any) {\r\n    return createRef(rawValue)\r\n}\r\n\r\nexport function shallowRef(rawValue:any) {\r\n    return createRef(rawValue,true)\r\n}\r\n\r\n// 创建RefImpl类\r\nclass RefImpl{\r\n    // 属性\r\n    public _v_isRef = true\r\n    public _value:any\r\n    constructor(public rawValue:any,public shallow:boolean) {\r\n      this._value = rawValue\r\n    }\r\n    // 类的属性访问器\r\n    get value() {\r\n        Track(this,TrackOpTypes.GET,'value')\r\n        return this._value\r\n    }\r\n    set value(newValue) {\r\n        if(hasChanged(newValue,this._value)) {\r\n            this._value =newValue\r\n            this.rawValue = newValue\r\n            trigger(this,TriggerOpTypes.SET,'value',newValue)\r\n        }\r\n        \r\n    }\r\n}\r\n\r\nfunction createRef(rawValue:any,shallow=false) {\r\n    return new RefImpl(rawValue,shallow)\r\n}\r\n\r\n\r\n// toRef 将我们的目标对象的某个属性变成 ref，如果这个属性目标对象不是响应式，那么toRef也不具备响应式\r\nexport function toRef(target:any,key:any) {\r\n    return new ObjectRefImpl(target,key)\r\n}\r\n\r\nclass ObjectRefImpl {\r\n    public _v_isRef = true\r\n    public _object:any\r\n    constructor(public target:any, public key:any) {\r\n        this._object = target[key]\r\n    }\r\n    get value() {\r\n        return this._object\r\n    }\r\n    set value(newValue) {\r\n        this._object = newValue\r\n        this.target[this.key] = newValue\r\n    }\r\n}\r\n\r\n\r\n// toRefs 将将我们的目标对象的所有属性变成 ref\r\nexport function toRefs(target:any) {\r\n    let res:any = isArray(target)?new Array(target.length):{}\r\n    for(let key in target) {\r\n        res[key] = toRef(target,key)\r\n    }\r\n    return res\r\n}","import { isFunction } from \"@vue/shared\";\r\nimport { effect } from \"./effect\";\r\n\r\n// computed计算属性有两个参数，一个是\r\nexport function computed(getterOrOptions:any) {\r\n    let getter;\r\n    let setter;\r\n    if (isFunction(getterOrOptions)) {\r\n        getter = getterOrOptions\r\n        setter = () => {\r\n            console.warn('computed value must be readonly')\r\n        }\r\n    } else {\r\n        getter = getterOrOptions.get\r\n        setter = getterOrOptions.set\r\n    }\r\n    return new ComputedRefImpl(getter,setter)\r\n}\r\n\r\nclass ComputedRefImpl {\r\n    public _v_isReadonly = true\r\n    public _v_isRef = true\r\n    public _dirty = true\r\n    public _value: any\r\n    public effect:any\r\n    constructor(getter:Function,public setter:Function) {\r\n        this.effect = effect(getter,{\r\n            lazy:true,\r\n            sch: () => {\r\n                if(!this._dirty) {\r\n                    this._dirty = true\r\n                }\r\n            }\r\n        })\r\n        \r\n    }\r\n    get value() {\r\n        // 获取执行\r\n        if(this._dirty) {\r\n          this._value = this.effect()\r\n          this._dirty = false\r\n        }\r\n        return this._value\r\n    }\r\n    set value(newValue) {\r\n        this.setter(newValue)\r\n    }\r\n}"],"names":[],"mappings":"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"}